import sys
import bioread


def print_as_table(lines):
    # Convert all values to strings
    lines = [[str(val) for val in line] for line in lines]
    # Get the maximum width of each column
    widths = [max(map(len, col)) for col in zip(*lines)]
    # Print the table
    for line in lines:
        print("  ".join((val.ljust(width) for val, width in zip(line, widths))))


def main(args):
    if len(args) != 1:
        print("Usage: python main.py [acq_file]")
        return

    data = bioread.read_file(args[0])
    assert data is not None

    lines = []
    for channel in data.channels:
        name = str(channel.name)
        data = channel.data
        if "DI_synchronization_" in name:
            name = "> " + name

        line = [name, len(data), data.min(), data.max(), data.sum(), data.mean()]  # type: ignore
        lines.append(line)

    print_as_table(lines)


if __name__ == "__main__":
    main(sys.argv[1:])

"""Examples:

python bioread_test.py examples/1h.acq

Output on Mac:
TSD115                      8262402  -0.0396728515625        0.0335693359375      -14072.381591796875  -0.001703182874882737 
SpO2, OXY100E               8262402  125.4504240011867       125.5006428006329    1036732593.584664    125.47593225125866    
SKT100C_room                8262402  22.337069939929187      22.429470385546864   184917250.77037796   22.380568116920234    
SKT100C_sub                 8262402  29.573126664721652      29.71511818541257    244902455.11132792   29.640588186259627    
RSP100C                     8262402  -0.02838134765625       -0.0250244140625     -220295.90057373047  -0.026662452465243215 
EDA100C                     8262402  -0.0030528288498032907  0.01373183911894671  39749.26375738775    0.004810860541206752  
PPG100C                     8262402  -0.01190185546875       0.18341064453125     703546.3870239258    0.08515034574981051   
PPG100C                     8262402  -0.69915771484375       -0.6085205078125     -5397955.715332031   -0.6533155510143456   
Rate, OXY100E               8262402  508.248756045387        508.4819975353423    4200279089.2719107   508.3605335678306     
EGG100C                     8262402  0.012664794921875       0.023345947265625    155532.32330322266   0.01882410506087971   
EMG100C                     8262402  -0.168914794921875      0.18280029296875     13734.120483398438   0.0016622430720991835 
EMG100C                     8262402  -0.8441162109375        0.8489990234375      23832.60772705078    0.00288446479934658   
EMG100C                     8262402  -0.584259033203125      0.585479736328125    19397.955322265625   0.002347738021251644  
ECG100C_lead_1              8262402  -0.015411376953125      0.014801025390625    -3129.6932983398438  -0.0003787873427533354
ECG100C_lead_2              8262402  -0.019683837890625      0.019989013671875    8367.925109863281    0.0010127714809644074 
> DI_synchronization_1      8262402  0.0                     5.0                  9906460.0            1.1989806354132855    
> DI_synchronization_2      8262402  0.0                     5.0                  9829835.0            1.1897066978827706    
ECG100C_lead_3_calculation  8262402  -0.019989013671875      0.023651123046875    11497.618408203125   0.0013915588237177427 

Output on Windows:
TSD115                      8262402  -0.0396728515625        0.0335693359375      -14072.381591796875  -0.001703182874882737 
SpO2, OXY100E               8262402  125.4504240011867       125.5006428006329    1036732593.584664    125.47593225125866    
SKT100C_room                8262402  22.337069939929187      22.429470385546864   184917250.77037796   22.380568116920234    
SKT100C_sub                 8262402  29.573126664721652      29.71511818541257    244902455.11132792   29.640588186259627    
RSP100C                     8262402  -0.02838134765625       -0.0250244140625     -220295.90057373047  -0.026662452465243215 
EDA100C                     8262402  -0.0030528288498032907  0.01373183911894671  39749.26375738775    0.004810860541206752  
PPG100C                     8262402  -0.01190185546875       0.18341064453125     703546.3870239258    0.08515034574981051   
PPG100C                     8262402  -0.69915771484375       -0.6085205078125     -5397955.715332031   -0.6533155510143456   
Rate, OXY100E               8262402  508.248756045387        508.4819975353423    4200279089.2719107   508.3605335678306     
EGG100C                     8262402  0.012664794921875       0.023345947265625    155532.32330322266   0.01882410506087971   
EMG100C                     8262402  -0.168914794921875      0.18280029296875     13734.120483398438   0.0016622430720991835 
EMG100C                     8262402  -0.8441162109375        0.8489990234375      23832.60772705078    0.00288446479934658   
EMG100C                     8262402  -0.584259033203125      0.585479736328125    19397.955322265625   0.002347738021251644  
ECG100C_lead_1              8262402  -0.015411376953125      0.014801025390625    -3129.6932983398438  -0.0003787873427533354
ECG100C_lead_2              8262402  -0.019683837890625      0.019989013671875    8367.925109863281    0.0010127714809644074 
> DI_synchronization_1      8262402  0.0                     5.0                  9906460.0            1.1989806354132855    
> DI_synchronization_2      8262402  0.0                     5.0                  9829835.0            1.1897066978827706    
ECG100C_lead_3_calculation  8262402  -0.019989013671875      0.023651123046875    11497.618408203125   0.0013915588237177427 

python bioread_test.py examples/7h.acq

Output on Mac:
TSD115                      51387171  -0.03662109375         0.030517578125       -76605.6396484375    -0.0014907541738080406 
SpO2, OXY100E               51387171  125.44656101661391     125.5006428006329    6447771653.388314    125.4743455985992      
SKT100C_room                51387171  23.01269521660155      23.344150026110828   1191848045.9407477   23.193494071521233     
SKT100C_sub                 51387171  29.594488971118135     29.72842724138181    1524068096.2418365   29.658532792977386     
RSP100C                     51387171  -0.09613037109375      0.01373291015625     -1369612.0825195312  -0.026652801776527672  
EDA100C                     51387171  -0.004578707756053291  0.01373183911894671  248566.91066513592   0.00483713942270019    
PPG100C                     51387171  0.040283203125         0.1287841796875      4387299.780883789    0.0853773363177317     
PPG100C                     51387171  -0.672607421875        -0.6341552734375     -33551446.154785156  -0.6529148326687444    
Rate, OXY100E               51387171  508.248756045387       508.497546968006     26123345506.30136    508.36317699414434     
EGG100C                     51387171  0.011138916015625      0.023956298828125    959572.4333190918    0.018673385100711065   
EMG100C                     51387171  -0.04486083984375      0.048065185546875    90746.98333740234    0.0017659462774746316  
EMG100C                     51387171  -1.07818603515625      1.0882568359375      144419.16244506836   0.0028104127865896406  
EMG100C                     51387171  -0.6146240234375       0.621795654296875    120961.93649291992   0.002353932589379554   
ECG100C_lead_1              51387171  -0.014190673828125     0.013275146484375    -20395.555572509766  -0.00039689975485340036
ECG100C_lead_2              51387171  -0.02105712890625      0.020599365234375    55009.0348815918     0.0010704818695232668  
> DI_synchronization_1      51387171  0.0                    5.0                  64017665.0           1.2457908025331847     
> DI_synchronization_2      51387171  0.0                    5.0                  63964270.0           1.2447517299599933     
ECG100C_lead_3_calculation  51387171  -0.021514892578125     0.02593994140625     75404.59045410156    0.0014673816243766671 

Output on Windows:
TSD115                      51387171  0.0                   0.0                   0.0                  0.0
SpO2, OXY100E               51387171  0.0                   0.0                   0.0                  0.0
SKT100C_room                51387171  32.2222222            32.2222222            1655808842.1915748   32.22222220000348
SKT100C_sub                 51387171  32.2222222            32.2222222            1655808842.1915748   32.22222220000348
RSP100C                     51387171  0.0                   0.0                   0.0                  0.0
EDA100C                     51387171  -0.07019150072480329  -0.07019150072480329  -3606942.6504927017  -0.07019150072481518
PPG100C                     51387171  0.0                   0.0                   0.0                  0.0
PPG100C                     51387171  0.0                   0.0                   0.0                  0.0
Rate, OXY100E               51387171  0.0                   0.0                   0.0                  0.0
EGG100C                     51387171  0.0                   0.0                   0.0                  0.0
EMG100C                     51387171  0.0                   0.0                   0.0                  0.0
EMG100C                     51387171  0.0                   0.0                   0.0                  0.0
EMG100C                     51387171  0.0                   0.0                   0.0                  0.0
ECG100C_lead_1              51387171  0.0                   0.0                   0.0                  0.0
ECG100C_lead_2              51387171  0.0                   0.0                   0.0                  0.0
> DI_synchronization_1      51387171  0.0                   0.0                   0.0                  0.0
> DI_synchronization_2      51387171  0.0                   0.0                   0.0                  0.0
ECG100C_lead_3_calculation  51387171  0.0                   0.0                   0.0                  0.0

python bioread_test.py examples/11h.acq

Output on Mac:
TSD115                      85526160  -0.0396728515625        0.0335693359375      -134279.18395996094  -0.0015700363954135313 
SpO2, OXY100E               85526160  125.44656101661391      125.5006428006329    10731354475.163311   125.4745270355095      
SKT100C_room                85526160  22.927076455065908      23.17969418712157    1971740114.6681504   23.05423410414019      
SKT100C_sub                 85526160  29.44444419999997       30.705413674792464   2520616692.071329    29.471879622227036     
RSP100C                     85526160  -0.11871337890625       0.0537109375         -2282056.6384887695  -0.026682556991787888  
EDA100C                     85526160  -0.0030528288498032907  0.01525771802519671  523394.4853283656    0.006119700514186134   
PPG100C                     85526160  0.03173828125           0.126953125          7292802.589416504    0.08526984713702221    
PPG100C                     85526160  -0.673828125            -0.63262939453125    -55867144.42840576   -0.6532170324074618    
Rate, OXY100E               85526160  508.2332066127233       508.4819975353423    43478164985.67922    508.3610089086102      
EGG100C                     85526160  0.0115966796875         0.02410888671875     1596160.838470459    0.018662837644885015   
EMG100C                     85526160  -0.046539306640625      0.048675537109375    152539.49142456055   0.0017835419177542936  
EMG100C                     85526160  -1.16973876953125       1.1767578125         242570.05996704102   0.002836208944339849   
EMG100C                     85526160  -0.651092529296875      0.659027099609375    200973.36013793945   0.0023498466450257963  
ECG100C_lead_1              85526160  -0.013885498046875      0.012664794921875    -33639.659729003906  -0.00039332596867442554
ECG100C_lead_2              85526160  -0.020751953125         0.0213623046875      90095.12802124023    0.0010534218772506592  
> DI_synchronization_1      85526160  0.0                     5.0                  106774915.0          1.2484474340950185     
> DI_synchronization_2      85526160  0.0                     5.0                  106774220.0          1.24843930792637       
ECG100C_lead_3_calculation  85526160  -0.0213623046875        0.02410888671875     123734.78775024414   0.0014467478459250847  

Output on Windows:
TSD115                      85526160  0.0                   0.0                   0.0                 0.0
SpO2, OXY100E               85526160  0.0                   0.0                   0.0                 0.0
SKT100C_room                85526160  32.2222222            32.2222222            2755842931.4333663  32.22222220000718
SKT100C_sub                 85526160  32.2222222            32.2222222            2755842931.4333663  32.22222220000718
RSP100C                     85526160  0.0                   0.0                   0.0                 0.0
EDA100C                     85526160  -0.07019150072480329  -0.07019150072480329  -6003209.521631223  -0.07019150072482178
PPG100C                     85526160  0.0                   0.0                   0.0                 0.0
PPG100C                     85526160  0.0                   0.0                   0.0                 0.0
Rate, OXY100E               85526160  0.0                   0.0                   0.0                 0.0
EGG100C                     85526160  0.0                   0.0                   0.0                 0.0
EMG100C                     85526160  0.0                   0.0                   0.0                 0.0
EMG100C                     85526160  0.0                   0.0                   0.0                 0.0
EMG100C                     85526160  0.0                   0.0                   0.0                 0.0
ECG100C_lead_1              85526160  0.0                   0.0                   0.0                 0.0
ECG100C_lead_2              85526160  0.0                   0.0                   0.0                 0.0
> DI_synchronization_1      85526160  0.0                   0.0                   0.0                 0.0
> DI_synchronization_2      85526160  0.0                   0.0                   0.0                 0.0
ECG100C_lead_3_calculation  85526160  0.0                   0.0                   0.0                 0.0
"""
